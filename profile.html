<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mijn Profiel - Ski Tracker</title>
    
    <!-- Google Fonts - Montserrat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Our CSS -->
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- Auth check - redirect to login if not logged in -->
    <div id="auth-check" style="display: none;"></div>
    
    <!-- Main Profile Page -->
    <div id="profile-page" class="profile-page" style="display: none;">
        <!-- Header matching main page -->
        <header class="site-header">
            <div class="header-content">
                <div class="header-left">
                    <h1>ğŸ‘¤ Mijn Profiel</h1>
                    <p class="subtitle">Beheer je gegevens en schrijf in je dagboek</p>
                </div>
                <div class="header-center">
                    <div class="user-info">
                        <img id="user-avatar" class="user-avatar" src="" alt="Avatar" style="display: none;" />
                        <span id="user-display-name">Gebruiker</span>
                        <a href="index.html" class="profile-button">Ã°Å¸ÂÂ  Home</a>
                        <button onclick="handleLogout()" class="logout-button">Uitloggen</button>
                    </div>
                </div>
                <div class="header-right">
                    <img src="logo.png" alt="Ski Tracker F&B" class="site-logo" />
                </div>
            </div>
        </header>
        
        <!-- Profile Content -->
        <div class="profile-content">
            <!-- Profile Navigation Tabs -->
            <div class="profile-nav">
                <button class="profile-nav-button active" onclick="switchProfileTab('details')">
                    <span class="nav-icon">ğŸ‘¤</span>
                    <span class="nav-text">Profiel</span>
                </button>
                <button class="profile-nav-button" onclick="switchProfileTab('packinglist')">
                    <span class="nav-icon">ğŸ’</span>
                    <span class="nav-text">Paklijst</span>
                </button>
                <button class="profile-nav-button" onclick="switchProfileTab('tips')">
                    <span class="nav-icon">ğŸ’¡</span>
                    <span class="nav-text">Tips & Ervaringen</span>
                </button>
                <button class="profile-nav-button" onclick="switchProfileTab('friends')">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span class="nav-text">Vrienden</span>
                </button>
            </div>
            
            <!-- Profile Details Section -->
            <div id="profile-section-details" class="profile-section active">
                <div class="profile-card">
                    <div class="profile-photo-section">
                        <div class="profile-photo-container" onclick="document.getElementById('profile-photo-input').click()">
                            <img id="profile-photo-preview" class="profile-photo" src="" alt="Profielfoto" style="display: none;" />
                            <div class="profile-photo-placeholder" id="profile-photo-placeholder">
                                <span>ğŸ“·</span>
                                <p>Voeg foto toe</p>
                            </div>
                            <div class="profile-photo-overlay">
                                <span>ğŸ“· Wijzig</span>
                            </div>
                        </div>
                        <input type="file" id="profile-photo-input" accept="image/*" style="display: none;" onchange="handleProfilePhotoChange(event)" />
                    </div>
                    
                    <form id="profile-form" class="profile-form">
                        <div class="profile-form-grid">
                            <div class="form-group">
                                <label>ğŸ‘¤ Naam</label>
                                <input type="text" id="profile-name" placeholder="Je naam" />
                            </div>
                            <div class="form-group">
                                <label>Ã°Å¸ÂÂ·Ã¯Â¸Â Gebruikersnaam</label>
                                <input type="text" id="profile-username" placeholder="Je unieke gebruikersnaam" pattern="[a-zA-Z0-9_]+" title="Alleen letters, cijfers en underscores" />
                                <small class="username-hint">Anderen kunnen je hiermee vinden</small>
                            </div>
                            <div class="form-group">
                                <label>ğŸ“§ E-mail</label>
                                <input type="email" id="profile-email" disabled />
                            </div>
                            <div class="form-group">
                                <label>Ã°Å¸â€œÂ Woonplaats</label>
                                <input type="text" id="profile-location" placeholder="Je woonplaats" />
                            </div>
                            <div class="form-group">
                                <label>ğŸ‚ Geboortedatum</label>
                                <input type="date" id="profile-birthdate" />
                            </div>
                            <div class="form-group">
                                <label>â›·ï¸Â Ski niveau</label>
                                <select id="profile-skill-level">
                                    <option value="">Selecteer niveau</option>
                                    <option value="beginner">Beginner</option>
                                    <option value="gevorderd">Gevorderd</option>
                                    <option value="expert">Expert</option>
                                    <option value="professional">Professional</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ğŸ¿ Favoriete ski-merk</label>
                                <input type="text" id="profile-favorite-brand" placeholder="Je favoriete ski-merk" />
                            </div>
                            <div class="form-group">
                                <label>Ã¢ÂÂ¤Ã¯Â¸Â Favoriete skigebied</label>
                                <input type="text" id="profile-favorite-resort" placeholder="Je favoriete skigebied" />
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label>Ã°Å¸â€œÂ Over mij</label>
                            <textarea id="profile-bio" placeholder="Vertel iets over jezelf en je ski-avonturen..." rows="3"></textarea>
                        </div>
                        <div class="profile-form-buttons">
                            <button type="button" onclick="saveProfile()" class="save-profile-button">ğŸ’¾ Profiel opslaan</button>
                        </div>
                        <p class="profile-save-message" id="profile-save-message"></p>
                    </form>
                </div>
                
                <!-- Statistics Card -->
                <div class="profile-card stats-card">
                    <h3>ğŸ“Š Mijn Statistieken</h3>
                    <div class="profile-stats-grid">
                        <div class="profile-stat-card">
                            <div class="profile-stat-number" id="profile-total-visits">0</div>
                            <div class="profile-stat-label">Totaal bezoeken</div>
                        </div>
                        <div class="profile-stat-card">
                            <div class="profile-stat-number" id="profile-unique-resorts">0</div>
                            <div class="profile-stat-label">Unieke skigebieden</div>
                        </div>
                        <div class="profile-stat-card">
                            <div class="profile-stat-number" id="profile-packing-items">0</div>
                            <div class="profile-stat-label">Paklijst items</div>
                        </div>
                        <div class="profile-stat-card">
                            <div class="profile-stat-number" id="profile-member-since">-</div>
                            <div class="profile-stat-label">Lid sinds</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Packing List Section -->
            <div id="profile-section-packinglist" class="profile-section">
                <div class="profile-card packing-list-card">
                    <div class="packing-list-header">
                        <h3>ğŸ’ Mijn Paklijst</h3>
                        <div class="packing-list-progress">
                            <span id="packing-progress-text">0 / 0 ingepakt</span>
                            <div class="progress-bar">
                                <div class="progress-fill" id="packing-progress-bar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Add New Item Form -->
                    <div class="packing-list-add">
                        <select id="new-packing-category">
                            <option value="vooraf">ğŸ“‹ Van tevoren regelen</option>
                            <option value="ski">â›·ï¸Â Ski uitrusting</option>
                            <option value="kleding">ğŸ‘• Vrijetijdskleding</option>
                            <option value="toiletartikelen">ğŸ§´ Toiletartikelen</option>
                            <option value="documenten">ğŸ“„ Belangrijke documenten</option>
                            <option value="overige">ğŸ“¦ Overige</option>
                        </select>
                        <input type="text" id="new-packing-item" placeholder="Nieuw item toevoegen..." onkeypress="handlePackingItemKeypress(event)" />
                        <button onclick="addPackingItem()" class="add-packing-button">+ Toevoegen</button>
                    </div>
                    
                    <!-- Packing List Categories -->
                    <div class="packing-list-categories" id="packing-list-categories">
                        <!-- Categories will be rendered here -->
                    </div>
                    
                    <!-- Packing List Actions -->
                    <div class="packing-list-actions" id="packing-list-actions" style="display: none;">
                        <button onclick="uncheckAllItems()" class="packing-action-button">Ã¢ËœÂ Alles uitvinken</button>
                        <button onclick="deleteCheckedItems()" class="packing-action-button delete">ğŸ—‘Ã¯Â¸Â Verwijder aangevinkte</button>
                        <button onclick="resetToDefaults()" class="packing-action-button reset">ğŸ”„ Herstel standaard</button>
                    </div>
                </div>
            </div>
            
            <!-- Tips & Ervaringen Section -->
            <div id="profile-section-tips" class="profile-section">
                <div class="profile-card tips-card">
                    <div class="tips-header">
                        <h3>ğŸ’¡ Tips & Ervaringen</h3>
                        <p class="tips-subtitle">Deel je ski tips en ervaringen</p>
                    </div>
                    
                    <!-- Add New Tip Form -->
                    <div class="tips-add-form">
                        <div class="tips-form-row">
                            <div class="form-group">
                                <label>ğŸ“Œ Onderwerp</label>
                                <input type="text" id="new-tip-subject" placeholder="Bijv. Beste restaurant in SÃ¶lden" />
                            </div>
                        </div>
                        <div class="tips-form-row">
                            <div class="form-group">
                                <label>Ã°Å¸â€œÂ Beschrijving</label>
                                <textarea id="new-tip-description" placeholder="Beschrijf je tip of ervaring..." rows="3"></textarea>
                            </div>
                        </div>
                        <div class="tips-form-row">
                            <div class="form-group">
                                <label>ğŸ“· Foto (optioneel)</label>
                                <div class="tips-photo-upload">
                                    <div class="tips-photo-preview-container" id="tip-photo-preview-container" style="display: none;">
                                        <img id="tip-photo-preview" src="" alt="Preview" />
                                        <button type="button" class="tips-photo-remove" onclick="removeTipPhoto()">Ã—</button>
                                    </div>
                                    <div class="tips-photo-dropzone" id="tip-photo-dropzone" onclick="document.getElementById('tip-photo-input').click()">
                                        <span>ğŸ“·</span>
                                        <p>Klik of sleep een foto</p>
                                    </div>
                                    <input type="file" id="tip-photo-input" accept="image/*" style="display: none;" onchange="handleTipPhotoChange(event)" />
                                </div>
                            </div>
                        </div>
                        <div class="tips-form-buttons">
                            <button type="button" onclick="addTip()" class="add-tip-button">ğŸ’¾ Tip opslaan</button>
                        </div>
                    </div>
                    
                    <!-- Tips List -->
                    <div class="tips-list" id="tips-list">
                        <p class="no-tips" id="no-tips">Je hebt nog geen tips of ervaringen toegevoegd.</p>
                    </div>
                </div>
            </div>
            
            <!-- Friends Section -->
            <div id="profile-section-friends" class="profile-section">
                <div class="profile-card friends-card">
                    <div class="friends-header">
                        <h3>ğŸ‘¥ Vrienden</h3>
                        <p class="friends-subtitle">Zoek en verbind met andere ski-enthousiastelingen</p>
                    </div>
                    
                    <!-- Pending Friend Requests (incoming) -->
                    <div class="pending-requests-section" id="pending-requests-section" style="display: none;">
                        <h4>ğŸ“¬ Vriendschapsverzoeken <span class="pending-badge" id="pending-count">0</span></h4>
                        <div class="pending-requests-list" id="pending-requests-list">
                            <!-- Incoming requests will appear here -->
                        </div>
                    </div>
                    
                    <!-- Search Users -->
                    <div class="friends-search">
                        <div class="search-input-container">
                            <input type="text" id="friend-search-input" placeholder="Zoek op gebruikersnaam..." onkeypress="handleFriendSearchKeypress(event)" />
                            <button onclick="searchUsers()" class="search-button">Ã°Å¸â€Â Zoeken</button>
                        </div>
                        <div class="search-results" id="search-results">
                            <!-- Search results will appear here -->
                        </div>
                    </div>
                    
                    <!-- Sent Requests (outgoing, waiting for acceptance) -->
                    <div class="sent-requests-section" id="sent-requests-section" style="display: none;">
                        <h4>Ã¢ÂÂ³ Verzonden verzoeken <span id="sent-requests-count">(0)</span></h4>
                        <div class="sent-requests-list" id="sent-requests-list">
                            <!-- Sent requests will appear here -->
                        </div>
                    </div>
                    
                    <!-- Friends List (mutual friends) -->
                    <div class="friends-list-section">
                        <h4>ğŸ‘¥ Mijn vrienden <span id="friends-count">(0)</span></h4>
                        <div class="friends-list" id="friends-list">
                            <p class="no-friends" id="no-friends">Je hebt nog geen vrienden. Zoek hierboven naar gebruikers!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Photo Lightbox -->
    <div id="photo-lightbox" class="photo-lightbox">
        <span class="photo-lightbox-close" onclick="closeLightbox()">&times;</span>
        <img id="lightbox-image" src="" alt="Foto" />
    </div>
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>Laden...</p>
    </div>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Our JavaScript -->
    <script src="firebase-config.js"></script>
    <script src="profile.js"></script>
</body>
</html>
